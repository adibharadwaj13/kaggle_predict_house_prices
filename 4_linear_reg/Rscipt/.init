set.seed(888)
total.n <- nrow(cleandummy)
random <- sample(seq(1, total.n), total.n*(2/3), replace = F)
train = cleandummy[random,]
test = cleandummy[-random,]
names(cleandummy)
reg<-lm(log(SalePrice)~., data=cleandummy)
summary(reg)
reg4<-lm(log(SalePrice)~MSSubClass+LotArea+OverallQual+OverallCond+YearBuilt+YearRemodAdd+ExterQual.Fa+ExterQual.Gd+BsmtQual.Fa+BsmtQual.Gd+BsmtQual.None+X1stFlrSF+X2ndFlrSF+BsmtFullBath+FullBath+Fireplaces+GarageArea+GarageQual.Fa+GarageQual.Gd+GarageQual.None+GarageQual.Po+WoodDeckSF+ScreenPorch+PoolArea+MSZoning.FV+MSZoning.RH+MSZoning.RL+MSZoning.RM+Neighborhood.BrDale+Neighborhood.BrkSide+Neighborhood.CollgCr+Neighborhood.Edwards+Neighborhood.Gilbert+Neighborhood.IDOTRR+Neighborhood.MeadowV+Neighborhood.Mitchel+Neighborhood.NAmes+Neighborhood.OldTown+Neighborhood.Sawyer+Neighborhood.SWISU+Condition2.PosA+BldgType.Twnhs+BldgType.TwnhsE+HouseStyle.1Story+HouseStyle.SFoyer+RoofMatl.WdShngl+Foundation.PConc+Foundation.Slab+Heating.GasW+HeatingQC.Fa+HeatingQC.Gd+HeatingQC.TA, data=train)
summary(reg4)
plot(rereg4<-lm(log(SalePrice)~MSSubClass+LotArea+OverallQual+OverallCond+YearBuilt+YearRemodAdd+ExterQual.Fa+ExterQual.Gd+BsmtQual.Fa+BsmtQual.Gd+BsmtQual.None+X1stFlrSF+X2ndFlrSF+BsmtFullBath+FullBath+Fireplaces+GarageArea+GarageQual.Fa+GarageQual.Gd+GarageQual.None+GarageQual.Po+WoodDeckSF+ScreenPorch+PoolArea+MSZoning.FV+MSZoning.RH+MSZoning.RL+MSZoning.RM+Neighborhood.BrDale+Neighborhood.BrkSide+Neighborhood.CollgCr+Neighborhood.Edwards+Neighborhood.Gilbert+Neighborhood.IDOTRR+Neighborhood.MeadowV+Neighborhood.Mitchel+Neighborhood.NAmes+Neighborhood.OldTown+Neighborhood.Sawyer+Neighborhood.SWISU+Condition2.PosA+BldgType.Twnhs+BldgType.TwnhsE+HouseStyle.1Story+HouseStyle.SFoyer+RoofMatl.WdShngl+Foundation.PConc+Foundation.Slab+Heating.GasW+HeatingQC.Fa+HeatingQC.Gd+HeatingQC.TA, data=train)g4, pch=8, which=1)
plot(reg4, pch=8, which=1)
qqnorm(reg4$residuals, pch=8, cex=.4, main="Q-Q Plot of Regression Residuals")
qqline(reg4$residuals, col="red")
plot(reg4$residuals, main="Scatterplot of Regression Residuals", ylab="Residuals", ylim=c(-1,1))
abline(0, 0, col="red")
hist(reg4$residuals, main="Histogram of Regression Residuals", xlab="Residuals", breaks=50, xlim=c(-1,1))
test_results <- predict(reg4, newdata=test, type="response")
summary(test_results)
summary(SalePrice)
